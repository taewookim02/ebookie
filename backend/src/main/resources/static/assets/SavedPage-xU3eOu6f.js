import{_ as I,f as m,j as D,z as S,o as i,a as v,e as t,p as $,A as B,g as u,l as c,B as f,F as k,C as z,t as C,x as h,n as N,k as p,u as P,D as V}from"./index-ibK3QWKb.js";const F={class:"saved"},L={class:"table"},M={colspan:"2"},R=["checked","onChange"],T=["src"],j={class:"text-muted"},E={class:"td-action"},U={key:1},q={__name:"SavedPage",setup(G){const o=m([]),n=D(),a=m(new Set),r=m(!1),_=async l=>{try{const e=await h.post("/api/v1/cart",{productId:l});n.success("장바구니 추가 완료!")}catch(e){console.log("handleCartClick() err:",e),n.error("장바구니 추가 중 에러 발생!")}},b=async l=>{try{const e=await h.delete(`/api/v1/saved/${l}`);o.value=o.value.filter(d=>d.productId!==l),a.value.delete(l),n.info("찜 목록에서 삭제 완료!")}catch(e){console.log("handleDeleteClick() err:",e),n.error("삭제 중 에러 발생!")}},y=()=>{r.value?a.value=new Set(o.value.map(l=>l.productId)):a.value.clear()},w=l=>{a.value.has(l)?(a.value.delete(l),r.value=!1):(a.value.add(l),r.value=a.value.size===o.value.length)},x=async()=>{if(a.value.size===0){n.warning("삭제할 상품을 선택해주세요");return}try{const l=Array.from(a.value);await h.delete("/api/v1/saved/bulk",{data:{productIds:l}}),o.value=o.value.filter(e=>!a.value.has(e.productId)),a.value.clear(),r.value=!1,n.info(`${l.length}개 상품이 찜 목록에서 삭제되었습니다`)}catch(l){console.log("handleCheckedDelete() err:",l),n.error("선택한 상품 삭제 중 에러가 발생했습니다!")}},A=async()=>{try{const l=await h.get("/api/v1/saved");o.value=l.data}catch(l){console.log("fetchSavedProducts() err:",l)}};return S(()=>{A()}),(l,e)=>{const d=N("RouterLink");return i(),v(k,null,[e[8]||(e[8]=t("h1",null,"찜한 상품",-1)),t("section",F,[t("table",L,[e[7]||(e[7]=t("colgroup",null,[t("col",{width:"1%"}),t("col",{width:"20%"}),t("col",{width:"*"}),t("col",{width:"20%"})],-1)),t("thead",null,[t("tr",null,[t("th",null,[$(t("input",{type:"checkbox",name:"all",id:"all","onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),onChange:y},null,544),[[B,r.value]])]),t("th",M,[e[2]||(e[2]=t("label",{for:"all"},"전체선택",-1)),u(f,{onAction:x,disabled:a.value.size===0,class:"btn-select-delete"},{default:c(()=>e[1]||(e[1]=[p("선택삭제")])),_:1},8,["disabled"])]),e[3]||(e[3]=t("th",null,null,-1))])]),t("tbody",null,[o.value&&o.value.length>0?(i(!0),v(k,{key:0},z(o.value,s=>(i(),v("tr",null,[t("td",null,[t("input",{type:"checkbox",checked:a.value.has(s.productId),onChange:g=>w(s.productId)},null,40,R)]),t("td",null,[u(d,{to:`/products/${s.productId}`},{default:c(()=>[t("img",{class:"img-product",src:P(V)(s.thumbnail),alt:"상품 이미지"},null,8,T)]),_:2},1032,["to"])]),t("td",null,[u(d,{to:`/products/${s.productId}`,class:"link-dark"},{default:c(()=>[p(C(s.name),1)]),_:2},1032,["to"]),t("div",j,[t("small",null,C(s.authorNames),1)])]),t("td",E,[u(f,{class:"w-100 mb-2",onAction:g=>_(s.productId)},{default:c(()=>e[4]||(e[4]=[p("장바구니 담기 ")])),_:2},1032,["onAction"]),u(f,{class:"w-100",onAction:g=>b(s.productId)},{default:c(()=>e[5]||(e[5]=[p("삭제")])),_:2},1032,["onAction"])])]))),256)):(i(),v("tr",U,e[6]||(e[6]=[t("td",{colspan:"4",class:"td-empty text-muted"},[t("small",null,"찜 한 상품이 없습니다.")],-1)])))])])])],64)}}},J=I(q,[["__scopeId","data-v-1b9bb123"]]);export{J as default};
