import{_ as I,o as n,c as w,b as e,F as B,n as P,t as m,s as b,D as N,p as r,K as G,G as j,L as u,e as z,k as O,d as o,w as L,A as E,P as J,H as q,r as C,l as V,M as H,E as A,f as Q,a as U,h as R,J as W,I as X,x as Z,N as ee}from"./index-Ct8V6wF8.js";import{D as te}from"./DeliveryAndRefundSection-DRLGzw03.js";import{L as se,S as oe,C as ae}from"./CartButton-Blp4e1rK.js";import{c as Y}from"./format-B6-WTpBz.js";const ie={class:"author-details"},le={class:"author-details-container"},re={class:"author-container"},ne={class:"author-header"},ce={class:"author-header__name"},de={class:"author-body"},ue={__name:"AuthorDetailsSection",props:{detailDto:Object},setup(l){return(c,s)=>(n(),w("section",ie,[s[0]||(s[0]=e("h3",null,"저자 소개",-1)),(n(!0),w(B,null,P(l.detailDto.authors,i=>(n(),w("div",le,[e("div",re,[e("div",ne,[e("span",ce,m(i.name)+" 저",1)]),e("div",de,[e("p",null,m(i.description),1)])])]))),256))]))}},ve=I(ue,[["__scopeId","data-v-c797d93d"]]),pe={class:"details"},me={class:"details-container"},_e={class:"details-category"},he={class:"details-info"},ge={__name:"BookDetailsSection",props:{detailDto:Object},setup(l){return(c,s)=>(n(),w("section",pe,[s[3]||(s[3]=e("h3",null,"작품소개",-1)),e("div",me,[e("div",_e,[s[0]||(s[0]=e("h4",{class:"details-category__heading"},"이 상품이 속한 분야",-1)),e("span",null,"eBook > IT > "+m(l.detailDto.categoryName),1)]),e("div",he,[s[1]||(s[1]=e("p",null," 파일은 결제내역 > 결제상세 > 다운로드 버튼을 눌러 다운로드 받으실 수 있습니다. (단, 로그인 및 결제 후 다운로드 이용 가능) ",-1)),s[2]||(s[2]=e("br",null,null,-1)),e("p",null,m(l.detailDto.description),1)])])]))}},we=I(ge,[["__scopeId","data-v-d2e62491"]]),fe={class:"hero"},ye=["src"],De={class:"hero__info"},$e={class:"info-header"},be={class:"info-header__title"},Se={class:"info-header__audit text-muted"},ke={class:"info-header__review"},xe={class:"info-header__review--icons"},Ie={class:"info-header__review--avg"},ze={class:"info-bottom pt-4"},Re={class:"info-bottom__price"},Ce={class:"price text-muted price-original"},Le={class:"d-flex align-items-center gap-2"},Ee={class:"price"},Be={key:0,class:"discount-badge"},Ne={class:"info-bottom__action"},Pe={__name:"HeroSection",props:{detailDto:Object},emits:["scrollToReview","save","like","cart","buy"],setup(l,{emit:c}){const s=l,i=window.location.origin,t=c,p=()=>{t("scrollToReview")},y=()=>t("save"),_=()=>t("like"),$=()=>t("cart"),g=()=>t("buy"),h=b(()=>s.detailDto&&s.detailDto.images&&s.detailDto.images.length>0?`${i}/api/v1/image?name=${s.detailDto.images[0].fileName}`:""),d=b(()=>{var f;const D=[];return(f=s.detailDto.authors)==null||f.forEach(x=>{D.push(x.name)}),D.join(", ")}),S=b(()=>{var D;if((D=s.detailDto)!=null&&D.publishedDate){const f=new Date(s.detailDto.publishedDate);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(f)}return""}),k=b(()=>{var f,x;let D=0;return(f=s.detailDto.reviews)==null||f.forEach(F=>{D+=F.rating}),D?(D/((x=s.detailDto.reviews)==null?void 0:x.length)).toFixed(1):0}),a=b(()=>(s.detailDto.price-s.detailDto.price*s.detailDto.discountRate/100).toLocaleString()),v=b(()=>{const D=parseFloat(k.value),f=[];for(let x=1;x<=5;x++)f.push(x<=D);return f});return(D,f)=>{var x,F;return n(),w("section",fe,[e("div",{class:j(["hero__image",{loading:!h.value}])},[h.value?(n(),w("img",{key:0,src:h.value,alt:"도서 썸네일"},null,8,ye)):(n(),N(r(G),{key:1,size:"64",color:"#ccc",margin:"auto"}))],2),e("div",De,[e("div",$e,[e("h1",be,m(l.detailDto.name),1),e("div",Se,[e("span",null,m(d.value)+" 저",1),f[0]||(f[0]=e("span",{class:"spacer"},"|",-1)),e("span",null,m(l.detailDto.publisherName),1),f[1]||(f[1]=e("span",{class:"spacer"},"|",-1)),e("span",null,m(S.value),1)]),e("div",ke,[e("div",xe,[(n(!0),w(B,null,P(v.value,(T,K)=>(n(),N(r(u),{key:K,size:16,color:T?"blue":"#ccc",weight:"fill",class:j({"empty-star":!T})},null,8,["color","class"]))),128))]),e("span",Ie,m(k.value),1),f[2]||(f[2]=e("span",{class:"spacer text-muted"},"|",-1)),e("span",null,[e("a",{to:"#",class:"link-dark",onClick:p},"회원리뷰("+m((x=l.detailDto.reviews)==null?void 0:x.length)+"건)",1)])])]),e("div",ze,[e("div",Re,[e("span",null,[f[3]||(f[3]=z("정가 ")),e("span",Ce,m((F=l.detailDto.price)==null?void 0:F.toLocaleString())+"원",1)]),e("span",Le,[f[4]||(f[4]=z("판매가 ")),e("strong",Ee,m(a.value)+"원",1),l.detailDto.discountRate?(n(),w("span",Be,m(l.detailDto.discountRate)+"% ",1)):O("",!0)])]),e("div",Ne,[o(se,{onLike:_,"is-active":l.detailDto.isLiked},null,8,["is-active"]),o(oe,{onSave:y,"is-active":l.detailDto.isSaved},null,8,["is-active"]),o(ae,{onCart:$,"is-active":l.detailDto.isInCart},null,8,["is-active"]),o(E,{onAction:g,"is-active":!0},{default:L(()=>f[5]||(f[5]=[z("구매하기")])),_:1})])])])])}}},Ae=I(Pe,[["__scopeId","data-v-e8f02d07"]]),Oe={class:"product-details"},Fe={class:"product-details__table table table-borderless"},je={__name:"ProductDetailsSection",props:{detailDto:Object},setup(l){const c=l;return(s,i)=>(n(),w("section",Oe,[i[5]||(i[5]=e("h3",null,"품목정보",-1)),e("table",Fe,[i[4]||(i[4]=e("colgroup",null,[e("col",{width:"20%"}),e("col",{width:"80%"})],-1)),e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("th",null,"발행일",-1)),e("td",null,m(r(Y)(c.detailDto.publishedDate)),1)]),i[1]||(i[1]=e("tr",null,[e("th",null,"이용안내"),e("td",null,[e("ul",null,[e("li",null,"배송 필요없음"),e("li",null,"결제 후 다운로드 가능"),e("li",null,"이용기간 제한없음")])])],-1)),i[2]||(i[2]=e("tr",null,[e("th",null,"파일포맷"),e("td",null,"PDF")],-1)),i[3]||(i[3]=e("tr",null,[e("th",null,"용량"),e("td",null,"11.83 MB")],-1))])])]))}},Te=I(je,[["__scopeId","data-v-f72e14e6"]]),Me={class:"related"},Ve={__name:"RelatedProductsSection",props:{productId:String,detailDto:Object,categoryId:Number},setup(l){const c=l;return(s,i)=>(n(),w("section",Me,[o(J,{products:c.detailDto.relatedProducts,sliderTitle:"관련 eBook 추천","category-id":c.categoryId},null,8,["products","category-id"])]))}},M=I(Ve,[["__scopeId","data-v-4cd71211"]]),He={class:"review-body"},Ue={class:"review-header"},Ye={class:"review-header__writer"},Ke={key:0,class:"review-header__controls"},Ge={class:"review-stars"},Je={class:"review-info"},qe={class:"text-muted review-info__date"},Qe={key:0,class:"review-content"},We={key:1,class:"review-form__container"},Xe={class:"text-muted char-count"},Ze={__name:"ReviewBody",props:{review:Object,isEditing:Boolean},emits:["edit","editOpen","editCancel","delete"],setup(l,{emit:c}){const s=q(),i=l,t=c,p=C(i.review.content),y=()=>{t("edit",i.review.id,p.value)},_=()=>{t("delete",i.review.id)},$=()=>{t("editOpen",i.review.id)},g=()=>{console.log("handleEditCancel"),p.value=i.review.content,t("editCancel")},h=b(()=>s.getMemberEmail===i.review.writerEmail),d=b(()=>{const k=parseFloat(i.review.rating),a=[];for(let v=1;v<=5;v++)a.push(v<=k);return a}),S=b(()=>`${p.value.length} / 50`);return(k,a)=>(n(),w("div",He,[e("div",Ue,[e("strong",Ye,m(l.review.writerEmail),1),h.value?(n(),w("div",Ke,[o(E,{onAction:_},{default:L(()=>a[1]||(a[1]=[z("삭제")])),_:1}),o(E,{onAction:$},{default:L(()=>a[2]||(a[2]=[z("수정")])),_:1})])):O("",!0)]),e("div",Ge,[(n(!0),w(B,null,P(d.value,v=>(n(),N(r(u),{size:16,color:v?"blue":"#ccc",weight:"fill"},null,8,["color"]))),256))]),e("div",Je,[e("small",qe,m(r(Y)(l.review.createdAt))+" 작성됨",1)]),l.isEditing?O("",!0):(n(),w("div",Qe,m(l.review.content),1)),l.isEditing?(n(),w("div",We,[V(e("textarea",{"onUpdate:modelValue":a[0]||(a[0]=v=>p.value=v),class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[H,p.value]]),e("div",null,[o(E,{class:"btn-action",onClick:y},{default:L(()=>a[3]||(a[3]=[z("저장")])),_:1}),o(E,{class:"btn-action",onClick:g},{default:L(()=>a[4]||(a[4]=[z("취소")])),_:1})]),e("small",Xe,m(S.value),1)])):O("",!0)]))}},et=I(Ze,[["__scopeId","data-v-96d8f0b4"]]),tt={class:"review-container"},st={class:"review-container__stars"},ot={class:"stars-heading"},at={class:"stars-main"},it={class:"stars-main__icons"},lt={class:"stars-main__numbers"},rt={class:"rating-avg"},nt={class:"review-container__percentage"},ct={class:"percetage-stars__row"},dt=["aria-valuenow"],ut={class:"percetage-stars__row"},vt=["aria-valuenow"],pt={class:"percetage-stars__row"},mt=["aria-valuenow"],_t={class:"percetage-stars__row"},ht=["aria-valuenow"],gt={class:"percetage-stars__row"},wt=["aria-valuenow"],ft={__name:"ReviewStats",props:{detailDto:Object},setup(l){const c=l,s=b(()=>{var y;return(y=c.detailDto.reviews)!=null&&y.length?(c.detailDto.reviews.reduce((_,$)=>_+$.rating,0)/c.detailDto.reviews.length).toFixed(1):0}),i=b(()=>{const p=parseFloat(s.value),y=[];for(let _=1;_<=5;_++)y.push(_<=p);return y}),t=b(()=>{var _;if(!((_=c.detailDto.reviews)!=null&&_.length))return[0,0,0,0,0];const p=[0,0,0,0,0],y=c.detailDto.reviews.length;return c.detailDto.reviews.forEach($=>{const g=Math.floor($.rating)-1;p[g]++}),p.map($=>($/y*100).toFixed(0))});return(p,y)=>{var _;return n(),w("div",tt,[e("div",st,[e("span",ot,m((_=l.detailDto.reviews)==null?void 0:_.length)+"명의 eBookie회원이 평가한 평균별점",1),e("div",at,[e("div",it,[(n(!0),w(B,null,P(i.value,($,g)=>(n(),N(r(u),{key:g,size:32,color:$?"var(--primary-color)":"var(--border-color)",weight:"fill",class:j({"empty-star":!$})},null,8,["color","class"]))),128))]),e("div",lt,[e("span",rt,m(s.value),1),y[0]||(y[0]=e("span",{class:"rating-total text-muted"}," / 5.0",-1))])])]),e("div",nt,[e("div",ct,[o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":t.value[4],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:A(`width: ${t.value[4]}%`)},m(t.value[4])+"%",5)],8,dt),e("div",ut,[o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":t.value[3],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:A(`width: ${t.value[3]}%`)},m(t.value[3])+"%",5)],8,vt),e("div",pt,[o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":t.value[2],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:A(`width: ${t.value[2]}%`)},m(t.value[2])+"%",5)],8,mt),e("div",_t,[o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":t.value[1],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:A(`width: ${t.value[1]}%`)},m(t.value[1])+"%",5)],8,ht),e("div",gt,[o(r(u),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"}),o(r(u),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":t.value[0],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:A(`width: ${t.value[0]}%`)},m(t.value[0])+"%",5)],8,wt)])])}}},yt=I(ft,[["__scopeId","data-v-4fc9ec57"]]),Dt={class:"review-form__rating"},$t={class:"review-form__container"},bt={class:"text-muted char-count"},St={__name:"ReviewForm",props:{detailDto:Object},emits:["save"],setup(l,{emit:c}){const s=C(""),i=C(0),t=c,p=()=>{t("save",{content:_.value,rating:i.value})},y=h=>{i.value=h},_=b({get:()=>s.value,set:h=>{s.value=h.substring(0,50)}}),$=b(()=>`${s.value.length} / 50`),g=b(()=>{const h=[];for(let d=1;d<=5;d++)h.push(d<=i.value);return h});return(h,d)=>(n(),w("form",{class:"review-form",onSubmit:Q(p,["prevent"])},[d[2]||(d[2]=e("h3",null,"리뷰 작성",-1)),e("div",Dt,[(n(!0),w(B,null,P(g.value,(S,k)=>(n(),N(r(u),{key:k,size:24,color:S?"blue":"#ccc",weight:"fill",class:"star-icon",onClick:a=>y(k+1)},null,8,["color","onClick"]))),128))]),e("div",$t,[V(e("textarea",{"onUpdate:modelValue":d[0]||(d[0]=S=>_.value=S),name:"content",id:"review-content",class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[H,_.value]]),o(E,{class:"btn-action",type:"submit"},{default:L(()=>d[1]||(d[1]=[z("등록")])),_:1}),e("small",bt,m($.value),1)])],32))}},kt=I(St,[["__scopeId","data-v-2803dfa9"]]),xt={class:"review"},It={__name:"ReviewSection",props:{detailDto:Object},setup(l){const c=U(),s=l,i=C(null),t=async g=>{if(g.rating===0){c.error("별점을 선택해주세요.");return}const d=(await R.post("/api/v1/reviews",{content:g.content,rating:g.rating,productId:s.detailDto.id})).data;s.detailDto.reviews.push(d)},p=async(g,h)=>{try{const d=await R.patch(`/api/v1/reviews/${g}`,{content:h});d.status<300&&(s.detailDto.reviews=s.detailDto.reviews.map(S=>S.id===g?d.data:S),c.success("리뷰가 수정되었습니다."),i.value=null)}catch(d){console.log(d)}},y=async g=>{try{(await R.delete(`/api/v1/reviews/${g}`)).status<300&&(s.detailDto.reviews=s.detailDto.reviews.filter(d=>d.id!==g),c.success("리뷰가 삭제되었습니다."),i.value=null)}catch(h){console.log(h)}},_=g=>{i.value=g},$=()=>{i.value=null};return(g,h)=>(n(),w("section",xt,[h[0]||(h[0]=e("div",{class:"review-header"},[e("h3",null,"회원리뷰")],-1)),o(yt,{"detail-dto":l.detailDto},null,8,["detail-dto"]),o(kt,{"detail-dto":l.detailDto,onSave:t},null,8,["detail-dto"]),(n(!0),w(B,null,P(l.detailDto.reviews,d=>(n(),N(et,{review:d,onEdit:p,onEditOpen:_,onEditCancel:$,onDelete:y,"is-editing":i.value===d.id},null,8,["review","is-editing"]))),256))]))}},zt=I(It,[["__scopeId","data-v-9a03f8f3"]]),Rt={key:0,class:"loading"},Ct={key:1,class:"empty-state"},Lt={__name:"ProductDetailPage",setup(l){const c=X(),s=Z(),i=C(null),t=C({}),p=U(),y=C(!0),_=C(!1),$=()=>{i.value.$el.scrollIntoView({behavior:"smooth"})},g=async()=>{try{const a=c.params.id;await R.post(`/api/v1/saved/${a}`),t.value.isSaved=!t.value.isSaved,t.value.isSaved?p.success("찜 목록에 저장 완료!"):p.info("찜 목록에서 삭제 완료!")}catch(a){console.log("handleSave() err:",a),a.status===401&&s.push("/login")}},h=async()=>{try{const a=c.params.id;await R.post(`/api/v1/liked/${a}`),t.value.isLiked=!t.value.isLiked,t.value.isLiked?p.success("좋아요 목록에 저장 완료!"):p.info("좋아요 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&s.push("/login")}},d=async()=>{try{const a=c.params.id;await R.post(`/api/v1/cart/${a}`),t.value.isInCart=!t.value.isInCart,t.value.isInCart?p.success("장바구니 목록에 저장 완료!"):p.info("장바구니 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&s.push("/login")}},S=async()=>{try{console.log("handleBuy");const a=[c.params.id],D=(await R.post("/api/v1/orders",{productIds:a})).data.id;s.push(`/orders/${D}`)}catch(a){console.log("handleBuy() err:",a),a.status===401&&s.push("/login")}},k=async a=>{var v;try{y.value=!0,_.value=!1;const D=await R.get(`/api/v1/products/${a}`);t.value=D.data}catch(D){console.log("err:",D),_.value=!0,((v=D.response)==null?void 0:v.status)===404?(p.error("존재하지 않는 상품입니다."),s.push("/products")):p.error("상품 정보를 불러올 수 없습니다.")}finally{y.value=!1}};return W(()=>c.params.id,a=>{a&&k(a)},{immediate:!0}),(a,v)=>y.value?(n(),w("div",Rt,[o(ee)])):_.value?(n(),w("div",Ct,[v[2]||(v[2]=e("i",{class:"bi bi-exclamation-circle",style:{"font-size":"4rem"}},null,-1)),v[3]||(v[3]=e("h3",{class:"mt-4"},"상품 정보를 불러올 수 없습니다",-1)),v[4]||(v[4]=e("p",{class:"text-muted"},"잠시 후 다시 시도해주세요.",-1)),o(E,{class:"mt-3",onAction:v[0]||(v[0]=D=>r(s).push("/products"))},{default:L(()=>v[1]||(v[1]=[z("상품 목록으로")])),_:1})])):t.value?(n(),w(B,{key:2},[o(Ae,{"detail-dto":t.value,onScrollToReview:$,onSave:g,onLike:h,onCart:d,onBuy:S},null,8,["detail-dto"]),o(M,{"detail-dto":t.value,"category-id":t.value.categoryId},null,8,["detail-dto","category-id"]),o(Te,{"detail-dto":t.value},null,8,["detail-dto"]),o(we,{"detail-dto":t.value},null,8,["detail-dto"]),o(ve,{"detail-dto":t.value},null,8,["detail-dto"]),o(zt,{ref_key:"reviewSection",ref:i,"detail-dto":t.value},null,8,["detail-dto"]),o(M,{"detail-dto":t.value,"category-id":t.value.categoryId},null,8,["detail-dto","category-id"]),o(te)],64)):O("",!0)}},At=I(Lt,[["__scopeId","data-v-7cb942a2"]]);export{At as default};
