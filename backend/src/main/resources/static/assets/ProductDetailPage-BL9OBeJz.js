import{_ as I,o as c,c as g,b as e,F as B,n as P,t as m,s as b,D as N,p as r,K as G,G as j,L as v,e as z,k as A,d as o,w as L,A as E,j as J,P as q,H as Q,r as C,l as U,M as H,N as W,E as O,f as X,a as Y,h as R,J as Z,I as ee,x as te,O as se}from"./index-B3n5MBAw.js";import{D as oe}from"./DeliveryAndRefundSection-CXsM-N3Q.js";import{L as ae,S as ie,C as le}from"./CartButton-CjRU1_pv.js";import{c as M}from"./format-B6-WTpBz.js";const re={class:"author-details"},ne={class:"author-details-container"},ce={class:"author-container"},de={class:"author-header"},ue={class:"author-header__name"},ve={class:"author-body"},pe={__name:"AuthorDetailsSection",props:{detailDto:Object},setup(i){return(n,t)=>(c(),g("section",re,[t[0]||(t[0]=e("h3",null,"저자 소개",-1)),(c(!0),g(B,null,P(i.detailDto.authors,l=>(c(),g("div",ne,[e("div",ce,[e("div",de,[e("span",ue,m(l.name)+" 저",1)]),e("div",ve,[e("p",null,m(l.description),1)])])]))),256))]))}},me=I(pe,[["__scopeId","data-v-ad103c13"]]),_e={class:"details"},he={class:"details-container"},ge={class:"details-category"},we={class:"details-info"},fe={__name:"BookDetailsSection",props:{detailDto:Object},setup(i){return(n,t)=>(c(),g("section",_e,[t[3]||(t[3]=e("h3",null,"작품소개",-1)),e("div",he,[e("div",ge,[t[0]||(t[0]=e("h4",{class:"details-category__heading"},"이 상품이 속한 분야",-1)),e("span",null,"eBook > IT > "+m(i.detailDto.categoryName),1)]),e("div",we,[t[1]||(t[1]=e("p",null," 파일은 결제내역 > 결제상세 > 다운로드 버튼을 눌러 다운로드 받으실 수 있습니다. (단, 로그인 및 결제 후 다운로드 이용 가능) ",-1)),t[2]||(t[2]=e("br",null,null,-1)),e("p",null,m(i.detailDto.description),1)])])]))}},ye=I(fe,[["__scopeId","data-v-8c961b1b"]]),De={class:"hero"},$e=["src"],be={class:"hero__info"},Se={class:"info-header"},ke={class:"info-header__title"},xe={class:"info-header__audit text-muted"},Ie={class:"info-header__review"},ze={class:"info-header__review--icons"},Re={class:"info-header__review--avg"},Ce={class:"info-bottom pt-4"},Le={class:"info-bottom__price"},Ee={class:"price text-muted price-original"},Be={class:"d-flex align-items-center gap-2"},Ne={class:"price"},Pe={key:0,class:"discount-badge"},Oe={class:"info-bottom__action"},Ae={__name:"HeroSection",props:{detailDto:Object},emits:["scrollToReview","save","like","cart","buy"],setup(i,{emit:n}){const t=i,l=window.location.origin,s=n,d=()=>{s("scrollToReview")},y=()=>s("save"),w=()=>s("like"),$=()=>s("cart"),h=()=>s("buy"),_=b(()=>t.detailDto&&t.detailDto.images&&t.detailDto.images.length>0?`${l}/api/v1/image?name=${t.detailDto.images[0].fileName}`:""),u=b(()=>{var f;const D=[];return(f=t.detailDto.authors)==null||f.forEach(x=>{D.push(x.name)}),D.join(", ")}),S=b(()=>{var D;if((D=t.detailDto)!=null&&D.publishedDate){const f=new Date(t.detailDto.publishedDate);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(f)}return""}),k=b(()=>{var f,x;let D=0;return(f=t.detailDto.reviews)==null||f.forEach(F=>{D+=F.rating}),D?(D/((x=t.detailDto.reviews)==null?void 0:x.length)).toFixed(1):0}),a=b(()=>(t.detailDto.price-t.detailDto.price*t.detailDto.discountRate/100).toLocaleString()),p=b(()=>{const D=parseFloat(k.value),f=[];for(let x=1;x<=5;x++)f.push(x<=D);return f});return(D,f)=>{var x,F;return c(),g("section",De,[e("div",{class:j(["hero__image",{loading:!_.value}])},[_.value?(c(),g("img",{key:0,src:_.value,alt:"도서 썸네일"},null,8,$e)):(c(),N(r(G),{key:1,size:"64",color:"#ccc",margin:"auto"}))],2),e("div",be,[e("div",Se,[e("h1",ke,m(i.detailDto.name),1),e("div",xe,[e("span",null,m(u.value)+" 저",1),f[0]||(f[0]=e("span",{class:"spacer"},"|",-1)),e("span",null,m(i.detailDto.publisherName),1),f[1]||(f[1]=e("span",{class:"spacer"},"|",-1)),e("span",null,m(S.value),1)]),e("div",Ie,[e("div",ze,[(c(!0),g(B,null,P(p.value,(T,K)=>(c(),N(r(v),{key:K,size:16,color:T?"blue":"#ccc",weight:"fill",class:j({"empty-star":!T})},null,8,["color","class"]))),128))]),e("span",Re,m(k.value),1),f[2]||(f[2]=e("span",{class:"spacer text-muted"},"|",-1)),e("span",null,[e("a",{to:"#",class:"link-dark",onClick:d},"회원리뷰("+m((x=i.detailDto.reviews)==null?void 0:x.length)+"건)",1)])])]),e("div",Ce,[e("div",Le,[e("span",null,[f[3]||(f[3]=z("정가 ")),e("span",Ee,m((F=i.detailDto.price)==null?void 0:F.toLocaleString())+"원",1)]),e("span",Be,[f[4]||(f[4]=z("판매가 ")),e("strong",Ne,m(a.value)+"원",1),i.detailDto.discountRate?(c(),g("span",Pe,m(i.detailDto.discountRate)+"% ",1)):A("",!0)])]),e("div",Oe,[o(ae,{onLike:w,"is-active":i.detailDto.isLiked},null,8,["is-active"]),o(ie,{onSave:y,"is-active":i.detailDto.isSaved},null,8,["is-active"]),o(le,{onCart:$,"is-active":i.detailDto.isInCart},null,8,["is-active"]),o(E,{onAction:h,"is-active":!0},{default:L(()=>f[5]||(f[5]=[z("구매하기")])),_:1})])])])])}}},Fe=I(Ae,[["__scopeId","data-v-c0e05cc1"]]),je={class:"product-details"},Me={class:"product-details__table table table-borderless"},Te={__name:"ProductDetailsSection",props:{detailDto:Object},setup(i){const n=i;return b(()=>M(n.detailDto.publishedDate)),J(()=>{}),(t,l)=>(c(),g("section",je,[l[5]||(l[5]=e("h3",null,"품목정보",-1)),e("table",Me,[l[4]||(l[4]=e("colgroup",null,[e("col",{width:"20%"}),e("col",{width:"80%"})],-1)),e("tbody",null,[e("tr",null,[l[0]||(l[0]=e("th",null,"발행일",-1)),e("td",null,m(r(M)(n.detailDto.publishedDate)),1)]),l[1]||(l[1]=e("tr",null,[e("th",null,"이용안내"),e("td",null,[e("ul",null,[e("li",null,"배송 필요없음"),e("li",null,"결제 후 다운로드 가능"),e("li",null,"이용기간 제한없음")])])],-1)),l[2]||(l[2]=e("tr",null,[e("th",null,"파일포맷"),e("td",null,"PDF")],-1)),l[3]||(l[3]=e("tr",null,[e("th",null,"용량"),e("td",null,"11.83 MB")],-1))])])]))}},Ve=I(Te,[["__scopeId","data-v-323f5df5"]]),Ue={class:"related"},He={__name:"RelatedProductsSection",props:{productId:String,detailDto:Object,categoryId:Number},setup(i){const n=i;return(t,l)=>(c(),g("section",Ue,[o(q,{products:n.detailDto.relatedProducts,sliderTitle:"관련 eBook 추천","category-id":n.categoryId},null,8,["products","category-id"])]))}},V=I(He,[["__scopeId","data-v-7a710162"]]),Ye={class:"review-body"},Ke={class:"review-header"},Ge={class:"review-header__writer"},Je={key:0,class:"review-header__controls"},qe={class:"review-stars"},Qe={class:"review-info"},We={class:"text-muted review-info__date"},Xe={key:0,class:"review-content"},Ze={key:1,class:"review-form__container"},et={class:"text-muted char-count"},tt={__name:"ReviewBody",props:{review:Object,isEditing:Boolean},emits:["edit","editOpen","editCancel","delete"],setup(i,{emit:n}){const t=i,l=Q(),s=n,d=C(t.review.content),y=()=>{s("edit",t.review.id,d.value)},w=()=>{s("delete",t.review.id)},$=()=>{s("editOpen",t.review.id)},h=()=>{console.log("handleEditCancel"),d.value=t.review.content,s("editCancel")},_=b(()=>l.getMemberEmail===t.review.writerEmail),u=b(()=>{const k=parseFloat(t.review.rating),a=[];for(let p=1;p<=5;p++)a.push(p<=k);return a}),S=b(()=>`${d.value.length} / 50`);return(k,a)=>(c(),g("div",Ye,[e("div",Ke,[e("strong",Ge,m(i.review.writerEmail),1),_.value?(c(),g("div",Je,[o(E,{onAction:w},{default:L(()=>a[1]||(a[1]=[z("삭제")])),_:1}),o(E,{onAction:$},{default:L(()=>a[2]||(a[2]=[z("수정")])),_:1})])):A("",!0)]),e("div",qe,[(c(!0),g(B,null,P(u.value,p=>(c(),N(r(v),{size:16,color:p?"blue":"#ccc",weight:"fill"},null,8,["color"]))),256))]),e("div",Qe,[e("small",We,m(r(M)(i.review.createdAt))+" 작성됨",1)]),i.isEditing?A("",!0):(c(),g("div",Xe,m(i.review.content),1)),i.isEditing?(c(),g("div",Ze,[U(e("textarea",{"onUpdate:modelValue":a[0]||(a[0]=p=>d.value=p),class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[H,d.value]]),e("div",null,[o(E,{class:"btn-action",onClick:y},{default:L(()=>a[3]||(a[3]=[z("저장")])),_:1}),o(E,{class:"btn-action",onClick:h},{default:L(()=>a[4]||(a[4]=[z("취소")])),_:1})]),e("small",et,m(S.value),1)])):A("",!0)]))}},st=I(tt,[["__scopeId","data-v-4852be6c"]]),ot={class:"review-container"},at={class:"review-container__stars"},it={class:"stars-heading"},lt={class:"stars-main"},rt={class:"stars-main__icons"},nt={class:"stars-main__numbers"},ct={class:"rating-avg"},dt={class:"review-container__percentage"},ut={class:"percetage-stars__row"},vt=["aria-valuenow"],pt={class:"percetage-stars__row"},mt=["aria-valuenow"],_t={class:"percetage-stars__row"},ht=["aria-valuenow"],gt={class:"percetage-stars__row"},wt=["aria-valuenow"],ft={class:"percetage-stars__row"},yt=["aria-valuenow"],Dt={__name:"ReviewStats",props:{detailDto:Object},setup(i){const n=i;W(()=>{});const t=b(()=>{var y;return(y=n.detailDto.reviews)!=null&&y.length?(n.detailDto.reviews.reduce((w,$)=>w+$.rating,0)/n.detailDto.reviews.length).toFixed(1):0}),l=b(()=>{const d=parseFloat(t.value),y=[];for(let w=1;w<=5;w++)y.push(w<=d);return y}),s=b(()=>{var w;if(!((w=n.detailDto.reviews)!=null&&w.length))return[0,0,0,0,0];const d=[0,0,0,0,0],y=n.detailDto.reviews.length;return n.detailDto.reviews.forEach($=>{const h=Math.floor($.rating)-1;d[h]++}),d.map($=>($/y*100).toFixed(0))});return(d,y)=>{var w;return c(),g("div",ot,[e("div",at,[e("span",it,m((w=i.detailDto.reviews)==null?void 0:w.length)+"명의 eBookie회원이 평가한 평균별점",1),e("div",lt,[e("div",rt,[(c(!0),g(B,null,P(l.value,($,h)=>(c(),N(r(v),{key:h,size:32,color:$?"var(--primary-color)":"var(--border-color)",weight:"fill",class:j({"empty-star":!$})},null,8,["color","class"]))),128))]),e("div",nt,[e("span",ct,m(t.value),1),y[0]||(y[0]=e("span",{class:"rating-total text-muted"}," / 5.0",-1))])])]),e("div",dt,[e("div",ut,[o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[4],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:O(`width: ${s.value[4]}%`)},m(s.value[4])+"%",5)],8,vt),e("div",pt,[o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[3],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:O(`width: ${s.value[3]}%`)},m(s.value[3])+"%",5)],8,mt),e("div",_t,[o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[2],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:O(`width: ${s.value[2]}%`)},m(s.value[2])+"%",5)],8,ht),e("div",gt,[o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[1],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:O(`width: ${s.value[1]}%`)},m(s.value[1])+"%",5)],8,wt),e("div",ft,[o(r(v),{size:16,weight:"fill",color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"}),o(r(v),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[0],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:O(`width: ${s.value[0]}%`)},m(s.value[0])+"%",5)],8,yt)])])}}},$t=I(Dt,[["__scopeId","data-v-4c067fc4"]]),bt={class:"review-form__rating"},St={class:"review-form__container"},kt={class:"text-muted char-count"},xt={__name:"ReviewForm",props:{detailDto:Object},emits:["save"],setup(i,{emit:n}){const t=C(""),l=C(0),s=n,d=b({get:()=>t.value,set:_=>{t.value=_.substring(0,50)}}),y=b(()=>`${t.value.length} / 50`),w=b(()=>{const _=[];for(let u=1;u<=5;u++)_.push(u<=l.value);return _}),$=()=>{s("save",{content:d.value,rating:l.value})},h=_=>{l.value=_};return(_,u)=>(c(),g("form",{class:"review-form",onSubmit:X($,["prevent"])},[u[2]||(u[2]=e("h3",null,"리뷰 작성",-1)),e("div",bt,[(c(!0),g(B,null,P(w.value,(S,k)=>(c(),N(r(v),{key:k,size:24,color:S?"blue":"#ccc",weight:"fill",class:"star-icon",onClick:a=>h(k+1)},null,8,["color","onClick"]))),128))]),e("div",St,[U(e("textarea",{"onUpdate:modelValue":u[0]||(u[0]=S=>d.value=S),name:"content",id:"review-content",class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[H,d.value]]),o(E,{class:"btn-action",type:"submit"},{default:L(()=>u[1]||(u[1]=[z("등록")])),_:1}),e("small",kt,m(y.value),1)])],32))}},It=I(xt,[["__scopeId","data-v-9421637d"]]),zt={class:"review"},Rt={__name:"ReviewSection",props:{detailDto:Object},setup(i){const n=Y(),t=i,l=C(null),s=async h=>{if(h.rating===0){n.error("별점을 선택해주세요.");return}const u=(await R.post("/api/v1/reviews",{content:h.content,rating:h.rating,productId:t.detailDto.id})).data;t.detailDto.reviews.push(u)},d=async(h,_)=>{try{const u=await R.patch(`/api/v1/reviews/${h}`,{content:_});u.status<300&&(t.detailDto.reviews=t.detailDto.reviews.map(S=>S.id===h?u.data:S),n.success("리뷰가 수정되었습니다."),l.value=null)}catch(u){console.log(u)}},y=async h=>{try{(await R.delete(`/api/v1/reviews/${h}`)).status<300&&(t.detailDto.reviews=t.detailDto.reviews.filter(u=>u.id!==h),n.success("리뷰가 삭제되었습니다."),l.value=null)}catch(_){console.log(_)}},w=h=>{l.value=h},$=()=>{l.value=null};return(h,_)=>(c(),g("section",zt,[_[0]||(_[0]=e("div",{class:"review-header"},[e("h3",null,"회원리뷰")],-1)),o($t,{"detail-dto":i.detailDto},null,8,["detail-dto"]),o(It,{"detail-dto":i.detailDto,onSave:s},null,8,["detail-dto"]),(c(!0),g(B,null,P(i.detailDto.reviews,u=>(c(),N(st,{review:u,onEdit:d,onEditOpen:w,onEditCancel:$,onDelete:y,"is-editing":l.value===u.id},null,8,["review","is-editing"]))),256))]))}},Ct=I(Rt,[["__scopeId","data-v-133324a1"]]),Lt={key:0,class:"loading"},Et={key:1,class:"empty-state"},Bt={__name:"ProductDetailPage",setup(i){const n=ee(),t=te(),l=C(null),s=C({}),d=Y(),y=C(!0),w=C(!1),$=()=>{l.value.$el.scrollIntoView({behavior:"smooth"})},h=async()=>{try{const a=n.params.id;await R.post(`/api/v1/saved/${a}`),s.value.isSaved=!s.value.isSaved,s.value.isSaved?d.success("찜 목록에 저장 완료!"):d.info("찜 목록에서 삭제 완료!")}catch(a){console.log("handleSave() err:",a),a.status===401&&t.push("/login")}},_=async()=>{try{const a=n.params.id;await R.post(`/api/v1/liked/${a}`),s.value.isLiked=!s.value.isLiked,s.value.isLiked?d.success("좋아요 목록에 저장 완료!"):d.info("좋아요 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&t.push("/login")}},u=async()=>{try{const a=n.params.id;await R.post(`/api/v1/cart/${a}`),s.value.isInCart=!s.value.isInCart,s.value.isInCart?d.success("장바구니 목록에 저장 완료!"):d.info("장바구니 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&t.push("/login")}},S=async()=>{try{console.log("handleBuy");const a=[n.params.id],D=(await R.post("/api/v1/orders",{productIds:a})).data.id;t.push(`/orders/${D}`)}catch(a){console.log("handleBuy() err:",a),a.status===401&&t.push("/login")}},k=async a=>{var p;try{y.value=!0,w.value=!1;const D=await R.get(`/api/v1/products/${a}`);s.value=D.data}catch(D){console.log("err:",D),w.value=!0,((p=D.response)==null?void 0:p.status)===404?(d.error("존재하지 않는 상품입니다."),t.push("/products")):d.error("상품 정보를 불러올 수 없습니다.")}finally{y.value=!1}};return Z(()=>n.params.id,a=>{a&&k(a)},{immediate:!0}),(a,p)=>y.value?(c(),g("div",Lt,[o(se)])):w.value?(c(),g("div",Et,[p[2]||(p[2]=e("i",{class:"bi bi-exclamation-circle",style:{"font-size":"4rem"}},null,-1)),p[3]||(p[3]=e("h3",{class:"mt-4"},"상품 정보를 불러올 수 없습니다",-1)),p[4]||(p[4]=e("p",{class:"text-muted"},"잠시 후 다시 시도해주세요.",-1)),o(E,{class:"mt-3",onAction:p[0]||(p[0]=D=>r(t).push("/products"))},{default:L(()=>p[1]||(p[1]=[z("상품 목록으로")])),_:1})])):s.value?(c(),g(B,{key:2},[o(Fe,{"detail-dto":s.value,onScrollToReview:$,onSave:h,onLike:_,onCart:u,onBuy:S},null,8,["detail-dto"]),o(V,{"detail-dto":s.value,"category-id":s.value.categoryId},null,8,["detail-dto","category-id"]),o(Ve,{"detail-dto":s.value},null,8,["detail-dto"]),o(ye,{"detail-dto":s.value},null,8,["detail-dto"]),o(me,{"detail-dto":s.value},null,8,["detail-dto"]),o(Ct,{ref_key:"reviewSection",ref:l,"detail-dto":s.value},null,8,["detail-dto"]),o(V,{"detail-dto":s.value,"category-id":s.value.categoryId},null,8,["detail-dto","category-id"]),o(oe)],64)):A("",!0)}},Ft=I(Bt,[["__scopeId","data-v-7cb942a2"]]);export{Ft as default};
