import{_ as B,r as c,i as R,s as q,j as D,I as F,o as i,c as d,a as s,t as n,F as V,n as z,b as v,w as C,p as S,k as N,C as A,H as E,x as M,g as m,f as T,q as Y,d as j}from"./index-DZyeJC7V.js";import{b as H}from"./format-B6-WTpBz.js";import{C as K,L as G,S as J}from"./CartButton-BVck5tvg.js";import{P as O}from"./Pagination-C4Afy_oj.js";const Q={class:"product-list-page"},U={key:0,class:"text-center py-5"},W={key:1,class:"text-center py-5"},X={key:2},Z={class:"product-grid"},ee={class:"product-image"},se=["src"],te={class:"product-info"},ae={class:"product-name"},oe={class:"text-decoration-line-through"},ne={class:"product-price"},ie={key:0,class:"badge text-bg-danger"},le={class:"product-actions"},re={__name:"ProductCategoryListPage",setup(ce){const l=c([]),h=c(0),y=c(0),r=c(0),f=c(!1),L=c(""),x=c(2),g=E(),p=M(),u=R(),I=q(()=>g.params.id),_=async()=>{f.value=!0;try{const t=await m.get(`/api/v1/products/categories/${I.value}?page=${r.value}&size=${x.value}`);l.value=t.data.products,h.value=t.data.totalPages,y.value=t.data.totalElements,r.value=t.data.currentPage,L.value=t.data.categoryName}catch(t){console.error("Failed to fetch products:",t),l.value=[]}finally{f.value=!1}};D(()=>{const t=Number(g.query.page)||0;r.value=t,_()}),F(()=>g.params.id,(t,e)=>{r.value=0,_()});const P=t=>{r.value=t-1,p.push({query:{...g.query,page:r.value}}),_()},b=async t=>{try{await m.post(`/api/v1/saved/${t}`);const e=l.value.find(o=>o.id===t);e&&(e.isSaved=!e.isSaved,e.isSaved?u.success("찜 목록에 저장 완료!"):u.info("찜 목록에서 삭제 완료!"))}catch(e){console.log("handleSave() err:",e),e.status===401&&p.push("/login")}},$=async t=>{try{await m.post(`/api/v1/liked/${t}`);const e=l.value.find(o=>o.id===t);e&&(e.isLiked=!e.isLiked,e.isLiked?u.success("좋아요 목록에 저장 완료!"):u.info("좋아요 목록에서 삭제 완료!"))}catch(e){console.log("handleLike() err:",e),e.status===401&&p.push("/login")}},w=async t=>{try{await m.post(`/api/v1/cart/${t}`);const e=l.value.find(o=>o.id===t);e&&(e.isInCart=!e.isInCart,e.isInCart?u.success("장바구니 목록에 저장 완료!"):u.info("장바구니 목록에서 삭제 완료!"))}catch(e){console.log("handleCartAdd() err:",e),e.status===401&&p.push("/login")}};return(t,e)=>{const o=T("RouterLink");return i(),d("div",Q,[s("h3",null,n(L.value)+" 분야",1),s("h4",null,"상품 ("+n(y.value.toLocaleString())+")",1),f.value?(i(),d("div",U,e[0]||(e[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):l.value.length?(i(),d("div",X,[s("div",Z,[(i(!0),d(V,null,z(l.value,a=>(i(),d("div",{class:"product-item",key:a.id},[s("div",ee,[v(o,{to:`/products/${a.id}`},{default:C(()=>[s("img",{src:S(Y)(a.thumbnail.fileName),alt:"상품 이미지"},null,8,se)]),_:2},1032,["to"])]),s("div",te,[s("span",ae,[v(o,{to:`/products/${a.id}`,class:"link-dark"},{default:C(()=>[j(n(a.name),1)]),_:2},1032,["to"])]),s("div",null,[s("span",null,n(a.authorNames)+" 저",1),e[2]||(e[2]=s("small",null,"|",-1)),s("span",null,n(a.publisherName),1),e[3]||(e[3]=s("small",null,"|",-1)),s("span",null,n(S(H)(a.publishedDate)),1)]),s("div",null,[s("small",oe,n(a.price.toLocaleString())+"원",1),s("span",ne,n((a.price-a.price*a.discountRate/100).toLocaleString())+"원",1),a.discountRate?(i(),d("span",ie,n(a.discountRate)+"%",1)):N("",!0)]),s("div",null,[s("span",null,"판매량 "+n(a.sold.toLocaleString())+"부",1)])]),s("div",le,[v(K,{onCart:k=>w(a.id),"is-active":a.isInCart},null,8,["onCart","is-active"]),v(G,{onLike:k=>$(a.id),"is-active":a.isLiked},null,8,["onLike","is-active"]),v(J,{onSave:k=>b(a.id),"is-active":a.isSaved},null,8,["onSave","is-active"])])]))),128))]),h.value>0?(i(),A(O,{key:0,"current-page":r.value+1,"total-pages":h.value,onPageChange:P},null,8,["current-page","total-pages"])):N("",!0)])):(i(),d("div",W,e[1]||(e[1]=[s("div",{class:"empty-state"},[s("i",{class:"bi bi-book",style:{"font-size":"4rem"}}),s("h3",{class:"mt-4"},"상품이 없습니다"),s("p",{class:"text-muted"},"해당하는 상품을 찾을 수 없습니다.")],-1)])))])}}},pe=B(re,[["__scopeId","data-v-19730516"]]);export{pe as default};
