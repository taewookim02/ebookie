import{y as S,z as p,s as g,o,c as l,A,k as C,m as B,a as t,_ as D,r as _,i as M,j as x,l as z,B as $,F as V,n as L,t as k,b as f,w as P,C as N,g as H,f as R,p as Z,q as U,d as j}from"./index-DZyeJC7V.js";import{A as I}from"./ActionButton-qA0NYUWD.js";import{P as E}from"./Pagination-C4Afy_oj.js";const F=["width","height","fill","transform"],O={key:0},T=t("path",{d:"M228,144v64a12,12,0,0,1-12,12H40a12,12,0,0,1-12-12V144a12,12,0,0,1,24,0v52H204V144a12,12,0,0,1,24,0Zm-108.49,8.49a12,12,0,0,0,17,0l40-40a12,12,0,0,0-17-17L140,115V32a12,12,0,0,0-24,0v83L96.49,95.51a12,12,0,0,0-17,17Z"},null,-1),q=[T],G={key:1},W=t("path",{d:"M216,48V208H40V48A16,16,0,0,1,56,32H200A16,16,0,0,1,216,48Z",opacity:"0.2"},null,-1),J=t("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40a8,8,0,0,0-11.32-11.32L136,124.69V32a8,8,0,0,0-16,0v92.69L93.66,98.34a8,8,0,0,0-11.32,11.32Z"},null,-1),K=[W,J],Q={key:2},X=t("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40A8,8,0,0,0,168,96H136V32a8,8,0,0,0-16,0V96H88a8,8,0,0,0-5.66,13.66Z"},null,-1),Y=[X],aa={key:3},ea=t("path",{d:"M222,144v64a6,6,0,0,1-6,6H40a6,6,0,0,1-6-6V144a6,6,0,0,1,12,0v58H210V144a6,6,0,0,1,12,0Zm-98.24,4.24a6,6,0,0,0,8.48,0l40-40a6,6,0,0,0-8.48-8.48L134,129.51V32a6,6,0,0,0-12,0v97.51L92.24,99.76a6,6,0,0,0-8.48,8.48Z"},null,-1),ta=[ea],oa={key:4},la=t("path",{d:"M224,144v64a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V144a8,8,0,0,1,16,0v56H208V144a8,8,0,0,1,16,0Zm-101.66,5.66a8,8,0,0,0,11.32,0l40-40a8,8,0,0,0-11.32-11.32L136,124.69V32a8,8,0,0,0-16,0v92.69L93.66,98.34a8,8,0,0,0-11.32,11.32Z"},null,-1),ra=[la],sa={key:5},na=t("path",{d:"M220,144v64a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V144a4,4,0,0,1,8,0v60H212V144a4,4,0,0,1,8,0Zm-94.83,2.83a4,4,0,0,0,5.66,0l40-40a4,4,0,1,0-5.66-5.66L132,134.34V32a4,4,0,0,0-8,0V134.34L90.83,101.17a4,4,0,0,0-5.66,5.66Z"},null,-1),ia=[na],ca={name:"PhDownloadSimple"},da=S({...ca,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(w){const r=w,i=p("weight","regular"),c=p("size","1em"),m=p("color","currentColor"),d=p("mirrored",!1),s=g(()=>r.weight??i),v=g(()=>r.size??c),y=g(()=>r.color??m),h=g(()=>r.mirrored!==void 0?r.mirrored?"scale(-1, 1)":void 0:d?"scale(-1, 1)":void 0);return(n,a)=>(o(),l("svg",B({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:v.value,height:v.value,fill:y.value,transform:h.value},n.$attrs),[A(n.$slots,"default"),s.value==="bold"?(o(),l("g",O,q)):s.value==="duotone"?(o(),l("g",G,K)):s.value==="fill"?(o(),l("g",Q,Y)):s.value==="light"?(o(),l("g",aa,ta)):s.value==="regular"?(o(),l("g",oa,ra)):s.value==="thin"?(o(),l("g",sa,ia)):C("",!0)],16,F))}}),ua={class:"library"},va={class:"page-controls"},pa=["value"],ga={key:0,class:"empty-state"},ma={key:1,class:"library-grid"},ya=["src","alt"],ha={class:"library-item__info"},ba={__name:"ProductLibraryPage",setup(w){const r=_({libraryDtos:[],totalPages:0,totalElements:0,currentPage:0}),i=_(0),c=_(10),m=[5,10,20,50],d=M(),s=async(n=0)=>{try{const a=await H.get(`/api/v1/products/library?page=${n}&size=${c.value}`);r.value=a.data,i.value=a.data.currentPage}catch(a){console.log("fetchLibrary() err:",a),d.error("라이브러리 목록을 불러올 수 없습니다.")}},v=n=>{s(n-1)},y=()=>{i.value=0,s(0)},h=async n=>{try{const a=await H.get(`/api/v1/products/files/download/${n}`,{responseType:"arraybuffer"}),b=new Blob([a.data],{type:"application/zip"}),e=window.URL.createObjectURL(b),u=document.createElement("a");u.href=e,u.download="files.zip",document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(e),d.success("다운로드가 시작됩니다.")}catch(a){console.log("handleDownload() err:",a),d.error("다운로드에 실패했습니다.")}};return x(()=>{s()}),(n,a)=>{const b=R("RouterLink");return o(),l("div",ua,[a[3]||(a[3]=t("h1",{class:"mb-4"},"내 서재",-1)),t("div",va,[z(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),onChange:y},[(o(),l(V,null,L(m,e=>t("option",{key:e,value:e},k(e)+"개씩 보기 ",9,pa)),64))],544),[[$,c.value]])]),r.value.libraryDtos.length===0?(o(),l("div",ga,a[1]||(a[1]=[t("p",null,"구매한 도서가 없습니다.",-1)]))):(o(),l("div",ma,[(o(!0),l(V,null,L(r.value.libraryDtos,e=>(o(),l("div",{key:e.productId,class:"library-item"},[f(b,{to:`/products/${e.productId}`},{default:P(()=>[t("img",{src:Z(U)(e.thumbnailUrl),alt:e.title,class:"library-item__image"},null,8,ya)]),_:2},1032,["to"]),t("div",ha,[t("h3",null,k(e.title),1),f(I,{onAction:()=>h(e.productId),class:"download-btn"},{default:P(()=>[f(Z(da)),a[2]||(a[2]=j(" 다운로드 "))]),_:2},1032,["onAction"])])]))),128))])),r.value.totalPages>1?(o(),N(E,{key:2,"current-page":i.value+1,"total-pages":r.value.totalPages,onPageChange:v},null,8,["current-page","total-pages"])):C("",!0)])}}},Va=D(ba,[["__scopeId","data-v-70b1aa2d"]]);export{Va as default};
