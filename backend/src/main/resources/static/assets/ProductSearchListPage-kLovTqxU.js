import{_ as b,a as w,r,s as B,j as D,J as R,o as c,c as d,b as s,t as n,d as v,p as y,F,n as V,w as N,D as z,k as A,I as E,x as M,h as m,g as T,q as Y,e as j}from"./index-Ct8V6wF8.js";import{b as G}from"./format-B6-WTpBz.js";import{L as J,S as K,C as H}from"./CartButton-Blp4e1rK.js";import{P as O}from"./Pagination-D4WC6-Wo.js";import{G as Q}from"./PhBookOpen.vue-BtNtNJCD.js";const U={class:"product-list-page"},W={key:0,class:"text-center py-5"},X={key:1,class:"text-center py-5"},Z={class:"empty-state"},ee={key:2},se={class:"product-grid"},te={class:"product-image"},ae=["src"],oe={class:"product-info"},ne={class:"product-name"},ie={class:"text-decoration-line-through"},le={class:"product-price",style:{color:"var(--primary-color)"}},re={class:"product-actions"},ce={__name:"ProductSearchListPage",setup(ue){const g=E(),p=M(),u=w(),i=r([]),h=r(0),L=r(0),l=r(0),_=r(!1),k=r(""),C=r(20),P=B(()=>g.query.query),x=async t=>{try{await m.post(`/api/v1/saved/${t}`);const e=i.value.find(o=>o.id===t);e&&(e.isSaved=!e.isSaved,e.isSaved?u.success("찜 목록에 저장 완료!"):u.info("찜 목록에서 삭제 완료!"))}catch(e){console.log("handleSave() err:",e),e.status===401&&p.push("/login")}},I=async t=>{try{await m.post(`/api/v1/liked/${t}`);const e=i.value.find(o=>o.id===t);e&&(e.isLiked=!e.isLiked,e.isLiked?u.success("좋아요 목록에 저장 완료!"):u.info("좋아요 목록에서 삭제 완료!"))}catch(e){console.log("handleLike() err:",e),e.status===401&&p.push("/login")}},$=async t=>{try{await m.post(`/api/v1/cart/${t}`);const e=i.value.find(o=>o.id===t);e&&(e.isInCart=!e.isInCart,e.isInCart?u.success("장바구니 목록에 저장 완료!"):u.info("장바구니 목록에서 삭제 완료!"))}catch(e){console.log("handleCartAdd() err:",e),e.status===401&&p.push("/login")}},f=async()=>{_.value=!0;try{const t=await m.get(`/api/v1/products/search/result?query=${P.value}&page=${l.value}&size=${C.value}`);i.value=t.data.products,h.value=t.data.totalPages,L.value=t.data.totalElements,l.value=t.data.currentPage,k.value=t.data.categoryName}catch(t){console.error("Failed to fetch products:",t),i.value=[]}finally{_.value=!1}},q=t=>{l.value=t-1,p.push({query:{...g.query,page:l.value}}),f()};return D(()=>{const t=Number(g.query.page)||0;l.value=t,f()}),R(()=>g.query.query,(t,e)=>{l.value=0,f()}),(t,e)=>{const o=T("RouterLink");return c(),d("div",U,[s("h3",null,n(k.value)+" 관련도서",1),s("h4",null,"상품 ("+n(L.value.toLocaleString())+")",1),_.value?(c(),d("div",W,e[0]||(e[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):i.value.length?(c(),d("div",ee,[s("div",se,[(c(!0),d(F,null,V(i.value,a=>(c(),d("div",{class:"product-item",key:a.id},[s("div",te,[v(o,{to:`/products/${a.id}`},{default:N(()=>[s("img",{src:y(Y)(a.thumbnail.fileName),alt:"상품 이미지"},null,8,ae)]),_:2},1032,["to"])]),s("div",oe,[s("span",ne,[v(o,{to:`/products/${a.id}`,class:"link-dark"},{default:N(()=>[j(n(a.name),1)]),_:2},1032,["to"])]),s("div",null,[s("small",null,n(a.authorNames)+" 저",1)]),s("div",null,[s("small",null,n(a.publisherName),1)]),s("div",null,[s("small",null,n(y(G)(a.publishedDate)),1)]),s("div",null,[s("small",ie,n(a.price.toLocaleString())+"원",1),s("span",le,n((a.price-a.price*a.discountRate/100).toLocaleString())+"원",1)]),s("div",null,[s("small",null,"판매량 "+n(a.sold.toLocaleString())+"부",1)])]),s("div",re,[v(J,{onLike:S=>I(a.id),"is-active":a.isLiked},null,8,["onLike","is-active"]),v(K,{onSave:S=>x(a.id),"is-active":a.isSaved},null,8,["onSave","is-active"]),v(H,{onCart:S=>$(a.id),"is-active":a.isInCart},null,8,["onCart","is-active"])])]))),128))]),h.value>0?(c(),z(O,{key:0,"current-page":l.value+1,"total-pages":h.value,onPageChange:q},null,8,["current-page","total-pages"])):A("",!0)])):(c(),d("div",X,[s("div",Z,[v(y(Q),{size:40,color:"var(--muted-color)"}),e[1]||(e[1]=s("h3",{class:"mt-4"},"상품이 없습니다",-1)),e[2]||(e[2]=s("p",{class:"text-muted"},"해당하는 상품을 찾을 수 없습니다.",-1))])]))])}}},he=b(ce,[["__scopeId","data-v-d6931ab2"]]);export{he as default};
