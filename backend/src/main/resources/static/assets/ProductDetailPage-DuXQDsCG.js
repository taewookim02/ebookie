import{_ as x,o as u,c as g,a as e,F as E,n as N,t as h,s as $,C as B,p as n,J as K,E as F,K as m,d as I,k as A,b as o,w as R,j as G,P as J,G as q,r as C,l as V,L as U,M as Q,D as P,e as W,i as H,g as z,I as X,H as Z,x as ee,N as te}from"./index-DElOj2gU.js";import{D as se}from"./DeliveryAndRefundSection-D-Tw9IGg.js";import{A as L}from"./ActionButton-vFkJGG1S.js";import{L as oe,S as ae,C as ie}from"./CartButton-DxdupJCD.js";import{c as j}from"./format-B6-WTpBz.js";/* empty css                                                                     */const le={class:"author-details"},re={class:"author-details-container"},ne={class:"author-container"},ce={class:"author-header"},de={class:"author-header__name"},ue={class:"author-body"},ve={__name:"AuthorDetailsSection",props:{detailDto:Object},setup(r){return(d,t)=>(u(),g("section",le,[t[0]||(t[0]=e("h3",null,"저자 소개",-1)),(u(!0),g(E,null,N(r.detailDto.authors,i=>(u(),g("div",re,[e("div",ne,[e("div",ce,[e("span",de,h(i.name)+" 저",1)]),e("div",ue,[e("p",null,h(i.description),1)])])]))),256))]))}},pe=x(ve,[["__scopeId","data-v-ad103c13"]]),me={class:"details"},_e={class:"details-container"},he={class:"details-category"},ge={class:"details-info"},we={__name:"BookDetailsSection",props:{detailDto:Object},setup(r){return(d,t)=>(u(),g("section",me,[t[3]||(t[3]=e("h3",null,"작품소개",-1)),e("div",_e,[e("div",he,[t[0]||(t[0]=e("h4",{class:"details-category__heading"},"이 상품이 속한 분야",-1)),e("span",null,"eBook > IT > "+h(r.detailDto.categoryName),1)]),e("div",ge,[t[1]||(t[1]=e("p",null," 파일은 결제내역 > 결제상세 > 다운로드 버튼을 눌러 다운로드 받으실 수 있습니다. (단, 로그인 및 결제 후 다운로드 이용 가능) ",-1)),t[2]||(t[2]=e("br",null,null,-1)),e("p",null,h(r.detailDto.description),1)])])]))}},fe=x(we,[["__scopeId","data-v-8c961b1b"]]),ye={class:"hero"},De=["src"],$e={class:"hero__info"},be={class:"info-header"},Se={class:"info-header__title"},ke={class:"info-header__audit text-muted"},xe={class:"info-header__review"},Ie={class:"info-header__review--icons"},ze={class:"info-header__review--avg"},Ce={class:"info-bottom pt-4"},Re={class:"info-bottom__price"},Le={class:"price text-muted price-original"},Ee={class:"d-flex align-items-center gap-2"},Be={class:"price"},Ne={key:0,class:"discount-badge"},Pe={class:"info-bottom__action"},Ae="http://localhost:8080",Oe={__name:"HeroSection",props:{detailDto:Object},emits:["scrollToReview","save","like","cart","buy"],setup(r,{emit:d}){const t=r,i=d,s=()=>{i("scrollToReview")},v=()=>i("save"),y=()=>i("like"),w=()=>i("cart"),D=()=>i("buy"),_=$(()=>t.detailDto&&t.detailDto.images&&t.detailDto.images.length>0?`${Ae}/api/v1/image?name=${t.detailDto.images[0].fileName}`:""),f=$(()=>{var c;const l=[];return(c=t.detailDto.authors)==null||c.forEach(S=>{l.push(S.name)}),l.join(", ")}),p=$(()=>{var l;if((l=t.detailDto)!=null&&l.publishedDate){const c=new Date(t.detailDto.publishedDate);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(c)}return""}),b=$(()=>{var c,S;let l=0;return(c=t.detailDto.reviews)==null||c.forEach(O=>{l+=O.rating}),l?(l/((S=t.detailDto.reviews)==null?void 0:S.length)).toFixed(1):0}),k=$(()=>(t.detailDto.price-t.detailDto.price*t.detailDto.discountRate/100).toLocaleString()),a=$(()=>{const l=parseFloat(b.value),c=[];for(let S=1;S<=5;S++)c.push(S<=l);return c});return(l,c)=>{var S,O;return u(),g("section",ye,[e("div",{class:F(["hero__image",{loading:!_.value}])},[_.value?(u(),g("img",{key:0,src:_.value,alt:"도서 썸네일"},null,8,De)):(u(),B(n(K),{key:1,size:"64",color:"#ccc",margin:"auto"}))],2),e("div",$e,[e("div",be,[e("h1",Se,h(r.detailDto.name),1),e("div",ke,[e("span",null,h(f.value)+" 저",1),c[0]||(c[0]=e("span",{class:"spacer"},"|",-1)),e("span",null,h(r.detailDto.publisherName),1),c[1]||(c[1]=e("span",{class:"spacer"},"|",-1)),e("span",null,h(p.value),1)]),e("div",xe,[e("div",Ie,[(u(!0),g(E,null,N(a.value,(M,Y)=>(u(),B(n(m),{key:Y,size:16,color:M?"blue":"#ccc",weight:"fill",class:F({"empty-star":!M})},null,8,["color","class"]))),128))]),e("span",ze,h(b.value),1),c[2]||(c[2]=e("span",{class:"spacer text-muted"},"|",-1)),e("span",null,[e("a",{to:"#",class:"link-dark",onClick:s},"회원리뷰("+h((S=r.detailDto.reviews)==null?void 0:S.length)+"건)",1)])])]),e("div",Ce,[e("div",Re,[e("span",null,[c[3]||(c[3]=I("정가 ")),e("span",Le,h((O=r.detailDto.price)==null?void 0:O.toLocaleString())+"원",1)]),e("span",Ee,[c[4]||(c[4]=I("판매가 ")),e("strong",Be,h(k.value)+"원",1),r.detailDto.discountRate?(u(),g("span",Ne,h(r.detailDto.discountRate)+"% ",1)):A("",!0)])]),e("div",Pe,[o(oe,{onLike:y,"is-active":r.detailDto.isLiked},null,8,["is-active"]),o(ae,{onSave:v,"is-active":r.detailDto.isSaved},null,8,["is-active"]),o(ie,{onCart:w,"is-active":r.detailDto.isInCart},null,8,["is-active"]),o(L,{onAction:D,"is-active":!0},{default:R(()=>c[5]||(c[5]=[I("구매하기")])),_:1})])])])])}}},Fe=x(Oe,[["__scopeId","data-v-a2ef7eb6"]]),je={class:"product-details"},Me={class:"product-details__table table table-borderless"},Te={__name:"ProductDetailsSection",props:{detailDto:Object},setup(r){const d=r;return $(()=>j(d.detailDto.publishedDate)),G(()=>{}),(t,i)=>(u(),g("section",je,[i[5]||(i[5]=e("h3",null,"품목정보",-1)),e("table",Me,[i[4]||(i[4]=e("colgroup",null,[e("col",{width:"20%"}),e("col",{width:"80%"})],-1)),e("tbody",null,[e("tr",null,[i[0]||(i[0]=e("th",null,"발행일",-1)),e("td",null,h(n(j)(d.detailDto.publishedDate)),1)]),i[1]||(i[1]=e("tr",null,[e("th",null,"이용안내"),e("td",null,[e("ul",null,[e("li",null,"배송 필요없음"),e("li",null,"결제 후 다운로드 가능"),e("li",null,"이용기간 제한없음")])])],-1)),i[2]||(i[2]=e("tr",null,[e("th",null,"파일포맷"),e("td",null,"PDF")],-1)),i[3]||(i[3]=e("tr",null,[e("th",null,"용량"),e("td",null,"11.83 MB")],-1))])])]))}},Ve=x(Te,[["__scopeId","data-v-323f5df5"]]),Ue={class:"related"},He={__name:"RelatedProductsSection",props:{productId:String,detailDto:Object,categoryId:Number},setup(r){const d=r;return(t,i)=>(u(),g("section",Ue,[o(J,{products:d.detailDto.relatedProducts,sliderTitle:"관련 eBook 추천","category-id":d.categoryId},null,8,["products","category-id"])]))}},T=x(He,[["__scopeId","data-v-7a710162"]]),Ye={class:"review-body"},Ke={class:"review-header"},Ge={class:"review-header__writer"},Je={key:0,class:"review-header__controls"},qe={class:"review-stars"},Qe={class:"review-info"},We={class:"text-muted review-info__date"},Xe={key:0,class:"review-content"},Ze={key:1,class:"review-form__container"},et={class:"text-muted char-count"},tt={__name:"ReviewBody",props:{review:Object,isEditing:Boolean},emits:["edit","editOpen","editCancel","delete"],setup(r,{emit:d}){const t=r,i=q(),s=d,v=C(t.review.content),y=()=>{s("edit",t.review.id,v.value)},w=()=>{s("delete",t.review.id)},D=()=>{s("editOpen",t.review.id)},_=()=>{console.log("handleEditCancel"),v.value=t.review.content,s("editCancel")},f=$(()=>i.getMemberEmail===t.review.writerEmail),p=$(()=>{const k=parseFloat(t.review.rating),a=[];for(let l=1;l<=5;l++)a.push(l<=k);return a}),b=$(()=>`${v.value.length} / 50`);return(k,a)=>(u(),g("div",Ye,[e("div",Ke,[e("strong",Ge,h(r.review.writerEmail),1),f.value?(u(),g("div",Je,[o(L,{onAction:w},{default:R(()=>a[1]||(a[1]=[I("삭제")])),_:1}),o(L,{onAction:D},{default:R(()=>a[2]||(a[2]=[I("수정")])),_:1})])):A("",!0)]),e("div",qe,[(u(!0),g(E,null,N(p.value,l=>(u(),B(n(m),{size:16,color:l?"blue":"#ccc",weight:"fill"},null,8,["color"]))),256))]),e("div",Qe,[e("small",We,h(n(j)(r.review.createdAt))+" 작성됨",1)]),r.isEditing?A("",!0):(u(),g("div",Xe,h(r.review.content),1)),r.isEditing?(u(),g("div",Ze,[V(e("textarea",{"onUpdate:modelValue":a[0]||(a[0]=l=>v.value=l),class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[U,v.value]]),e("div",null,[o(L,{class:"btn-action",onClick:y},{default:R(()=>a[3]||(a[3]=[I("저장")])),_:1}),o(L,{class:"btn-action",onClick:_},{default:R(()=>a[4]||(a[4]=[I("취소")])),_:1})]),e("small",et,h(b.value),1)])):A("",!0)]))}},st=x(tt,[["__scopeId","data-v-4852be6c"]]),ot={class:"review-container"},at={class:"review-container__stars"},it={class:"stars-heading"},lt={class:"stars-main"},rt={class:"stars-main__icons"},nt={class:"stars-main__numbers"},ct={class:"rating-avg"},dt={class:"review-container__percentage"},ut={class:"percetage-stars__row"},vt=["aria-valuenow"],pt={class:"percetage-stars__row"},mt=["aria-valuenow"],_t={class:"percetage-stars__row"},ht=["aria-valuenow"],gt={class:"percetage-stars__row"},wt=["aria-valuenow"],ft={class:"percetage-stars__row"},yt=["aria-valuenow"],Dt={__name:"ReviewStats",props:{detailDto:Object},setup(r){const d=r;Q(()=>{});const t=$(()=>{var y;return(y=d.detailDto.reviews)!=null&&y.length?(d.detailDto.reviews.reduce((w,D)=>w+D.rating,0)/d.detailDto.reviews.length).toFixed(1):0}),i=$(()=>{const v=parseFloat(t.value),y=[];for(let w=1;w<=5;w++)y.push(w<=v);return y}),s=$(()=>{var w;if(!((w=d.detailDto.reviews)!=null&&w.length))return[0,0,0,0,0];const v=[0,0,0,0,0],y=d.detailDto.reviews.length;return d.detailDto.reviews.forEach(D=>{const _=Math.floor(D.rating)-1;v[_]++}),v.map(D=>(D/y*100).toFixed(0))});return(v,y)=>{var w;return u(),g("div",ot,[e("div",at,[e("span",it,h((w=r.detailDto.reviews)==null?void 0:w.length)+"명의 eBookie회원이 평가한 평균별점",1),e("div",lt,[e("div",rt,[(u(!0),g(E,null,N(i.value,(D,_)=>(u(),B(n(m),{key:_,size:32,color:D?"var(--primary-color)":"var(--border-color)",weight:"fill",class:F({"empty-star":!D})},null,8,["color","class"]))),128))]),e("div",nt,[e("span",ct,h(t.value),1),y[0]||(y[0]=e("span",{class:"rating-total text-muted"}," / 5.0",-1))])])]),e("div",dt,[e("div",ut,[o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[4],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:P(`width: ${s.value[4]}%`)},h(s.value[4])+"%",5)],8,vt),e("div",pt,[o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[3],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:P(`width: ${s.value[3]}%`)},h(s.value[3])+"%",5)],8,mt),e("div",_t,[o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[2],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:P(`width: ${s.value[2]}%`)},h(s.value[2])+"%",5)],8,ht),e("div",gt,[o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[1],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:P(`width: ${s.value[1]}%`)},h(s.value[1])+"%",5)],8,wt),e("div",ft,[o(n(m),{size:16,weight:"fill",color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"}),o(n(m),{size:16,color:"var(--primary-color)"})]),e("div",{class:"progress",role:"progressbar","aria-valuenow":s.value[0],"aria-valuemin":"0","aria-valuemax":"100"},[e("div",{class:"progress-bar",style:P(`width: ${s.value[0]}%`)},h(s.value[0])+"%",5)],8,yt)])])}}},$t=x(Dt,[["__scopeId","data-v-4c067fc4"]]),bt={class:"review-form__rating"},St={class:"review-form__container"},kt={class:"text-muted char-count"},xt={__name:"ReviewForm",props:{detailDto:Object},emits:["save"],setup(r,{emit:d}){const t=C(""),i=C(0),s=d,v=$({get:()=>t.value,set:f=>{t.value=f.substring(0,50)}}),y=$(()=>`${t.value.length} / 50`),w=$(()=>{const f=[];for(let p=1;p<=5;p++)f.push(p<=i.value);return f}),D=()=>{s("save",{content:v.value,rating:i.value})},_=f=>{i.value=f};return(f,p)=>(u(),g("form",{class:"review-form",onSubmit:W(D,["prevent"])},[p[2]||(p[2]=e("h3",null,"리뷰 작성",-1)),e("div",bt,[(u(!0),g(E,null,N(w.value,(b,k)=>(u(),B(n(m),{key:k,size:24,color:b?"blue":"#ccc",weight:"fill",class:"star-icon",onClick:a=>_(k+1)},null,8,["color","onClick"]))),128))]),e("div",St,[V(e("textarea",{"onUpdate:modelValue":p[0]||(p[0]=b=>v.value=b),name:"content",id:"review-content",class:"review-content form-control w-100",rows:"3",maxlength:"50"},null,512),[[U,v.value]]),o(L,{class:"btn-action",type:"submit"},{default:R(()=>p[1]||(p[1]=[I("등록")])),_:1}),e("small",kt,h(y.value),1)])],32))}},It=x(xt,[["__scopeId","data-v-9421637d"]]),zt={class:"review"},Ct={__name:"ReviewSection",props:{detailDto:Object},setup(r){const d=H(),t=r,i=C(null),s=async _=>{if(_.rating===0){d.error("별점을 선택해주세요.");return}const p=(await z.post("/api/v1/reviews",{content:_.content,rating:_.rating,productId:t.detailDto.id})).data;t.detailDto.reviews.push(p)},v=async(_,f)=>{try{const p=await z.patch(`/api/v1/reviews/${_}`,{content:f});p.status<300&&(t.detailDto.reviews=t.detailDto.reviews.map(b=>b.id===_?p.data:b),d.success("리뷰가 수정되었습니다."),i.value=null)}catch(p){console.log(p)}},y=async _=>{try{(await z.delete(`/api/v1/reviews/${_}`)).status<300&&(t.detailDto.reviews=t.detailDto.reviews.filter(p=>p.id!==_),d.success("리뷰가 삭제되었습니다."),i.value=null)}catch(f){console.log(f)}},w=_=>{i.value=_},D=()=>{i.value=null};return(_,f)=>(u(),g("section",zt,[f[0]||(f[0]=e("div",{class:"review-header"},[e("h3",null,"회원리뷰")],-1)),o($t,{"detail-dto":r.detailDto},null,8,["detail-dto"]),o(It,{"detail-dto":r.detailDto,onSave:s},null,8,["detail-dto"]),(u(!0),g(E,null,N(r.detailDto.reviews,p=>(u(),B(st,{review:p,onEdit:v,onEditOpen:w,onEditCancel:D,onDelete:y,"is-editing":i.value===p.id},null,8,["review","is-editing"]))),256))]))}},Rt=x(Ct,[["__scopeId","data-v-133324a1"]]),Lt={key:0,class:"loading"},Et={key:1,class:"empty-state"},Bt={__name:"ProductDetailPage",setup(r){const d=Z(),t=ee(),i=C(null),s=C({}),v=H(),y=C(!0),w=C(!1),D=()=>{i.value.$el.scrollIntoView({behavior:"smooth"})},_=async a=>{var l;try{y.value=!0,w.value=!1;const c=await z.get(`/api/v1/products/${a}`);s.value=c.data}catch(c){console.log("err:",c),w.value=!0,((l=c.response)==null?void 0:l.status)===404?(v.error("존재하지 않는 상품입니다."),t.push("/products")):v.error("상품 정보를 불러올 수 없습니다.")}finally{y.value=!1}};X(()=>d.params.id,a=>{a&&_(a)},{immediate:!0});const f=async()=>{try{const a=d.params.id;await z.post(`/api/v1/saved/${a}`),s.value.isSaved=!s.value.isSaved,s.value.isSaved?v.success("찜 목록에 저장 완료!"):v.info("찜 목록에서 삭제 완료!")}catch(a){console.log("handleSave() err:",a),a.status===401&&t.push("/login")}},p=async()=>{try{const a=d.params.id;await z.post(`/api/v1/liked/${a}`),s.value.isLiked=!s.value.isLiked,s.value.isLiked?v.success("좋아요 목록에 저장 완료!"):v.info("좋아요 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&t.push("/login")}},b=async()=>{try{const a=d.params.id;await z.post(`/api/v1/cart/${a}`),s.value.isInCart=!s.value.isInCart,s.value.isInCart?v.success("장바구니 목록에 저장 완료!"):v.info("장바구니 목록에서 삭제 완료!")}catch(a){console.log("handleLike() err:",a),a.status===401&&t.push("/login")}},k=async()=>{try{console.log("handleBuy");const a=[d.params.id],c=(await z.post("/api/v1/orders",{productIds:a})).data.id;t.push(`/orders/${c}`)}catch(a){console.log("handleBuy() err:",a),a.status===401&&t.push("/login")}};return(a,l)=>y.value?(u(),g("div",Lt,[o(te)])):w.value?(u(),g("div",Et,[l[2]||(l[2]=e("i",{class:"bi bi-exclamation-circle",style:{"font-size":"4rem"}},null,-1)),l[3]||(l[3]=e("h3",{class:"mt-4"},"상품 정보를 불러올 수 없습니다",-1)),l[4]||(l[4]=e("p",{class:"text-muted"},"잠시 후 다시 시도해주세요.",-1)),o(L,{class:"mt-3",onAction:l[0]||(l[0]=c=>n(t).push("/products"))},{default:R(()=>l[1]||(l[1]=[I("상품 목록으로")])),_:1})])):s.value?(u(),g(E,{key:2},[o(Fe,{"detail-dto":s.value,onScrollToReview:D,onSave:f,onLike:p,onCart:b,onBuy:k},null,8,["detail-dto"]),o(T,{"detail-dto":s.value,"category-id":s.value.categoryId},null,8,["detail-dto","category-id"]),o(Ve,{"detail-dto":s.value},null,8,["detail-dto"]),o(fe,{"detail-dto":s.value},null,8,["detail-dto"]),o(pe,{"detail-dto":s.value},null,8,["detail-dto"]),o(Rt,{ref_key:"reviewSection",ref:i,"detail-dto":s.value},null,8,["detail-dto"]),o(T,{"detail-dto":s.value,"category-id":s.value.categoryId},null,8,["detail-dto","category-id"]),o(se)],64)):A("",!0)}},Mt=x(Bt,[["__scopeId","data-v-2386f5fb"]]);export{Mt as default};
